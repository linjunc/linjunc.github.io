import{_ as s,c as a,o as n,V as o}from"./chunks/framework.3d11d069.js";const A=JSON.parse('{"title":"React 入门学习（十四）-- redux 基本使用","description":"在我们之前写的案例当中，例如：todolist 案例，GitHub 搜索案例当中，我们对于状态的管理，都显得力不从心，redux可以帮助我们做集中式状态管理","frontmatter":{"title":"React 入门学习（十四）-- redux 基本使用","date":"2021-09-09T14:32:25.000Z","id":1635582745,"tags":["react","redux"],"categories":["React入门学习"],"keywords":"react,redux,小丞同学","description":"在我们之前写的案例当中，例如：todolist 案例，GitHub 搜索案例当中，我们对于状态的管理，都显得力不从心，redux可以帮助我们做集中式状态管理"},"headers":[],"relativePath":"pages/react/primary/redux.md","filePath":"pages/react/primary/redux.md","lastUpdated":1690121405000}'),e={name:"pages/react/primary/redux.md"},l=o(`<p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/redux%E5%9F%BA%E7%A1%80.gif" alt="redux基础" data-fancybox="gallery"></p><blockquote><p>📢 大家好，我是小丞同学，一名<div color="#2e86de"><strong>大二的前端爱好者</strong></div></p><p>📢 这篇文章是学习 Redux 的学习笔记</p><p>📢 非常感谢你的阅读，不对的地方欢迎指正 🙏</p><p>📢 <div color="#f368e0"><strong>愿你忠于自己，热爱生活</strong></div></p></blockquote><h2 id="引言" tabindex="-1">引言 <a class="header-anchor" href="#引言" aria-label="Permalink to &quot;引言&quot;">​</a></h2><p>在了解了 Antd 组件库之后，我们现在开始学习了 Redux ，在我们之前写的案例当中，例如：todolist 案例，GitHub 搜索案例当中，我们对于状态的管理，都是通过 state 来实现的，比如，我们在给兄弟组件传递数据时，需要先将数据传递给父组件，再由父组件转发 给它的子组件。这个过程十分的复杂，后来我们又学习了<strong>消息的发布订阅</strong>，我们通过 <strong>pubsub</strong> 库，实现了消息的转发，直接将数据发布，由兄弟组件订阅，实现了兄弟组件间的数据传递。但是，随着我们的需求不断地提升，我们需要进行更加复杂的数据传递，更多层次的数据交换。<strong>因此我们为何不可以将所有的数据交给一个中转站，这个中转站独立于所有的组件之外，由这个中转站来进行数据的分发，这样不管哪个组件需要数据，我们都可以很轻易的给他派发。</strong></p><p>而有这么一个库就可以帮助我们来实现，那就是 Redux ，它可以帮助我们实现集中式状态管理</p><h2 id="_1-什么情况使用-redux" tabindex="-1">1. 什么情况使用 Redux ？ <a class="header-anchor" href="#_1-什么情况使用-redux" aria-label="Permalink to &quot;1. 什么情况使用 Redux ？&quot;">​</a></h2><p>首先，我们先明晰 <code>Redux</code> 的作用 ，实现集中式状态管理。</p><p><code>Redux</code> 适用于多交互、多数据源的场景。简单理解就是<strong>复杂</strong></p><p>从组件角度去考虑的话，当我们有以下的应用场景时，我们可以尝试采用 <code>Redux</code> 来实现</p><ol><li>某个组件的状态需要共享时</li><li>一个组件需要改变其他组件的状态时</li><li>一个组件需要改变全局的状态时</li></ol><p>除此之外，还有很多情况都需要使用 Redux 来实现（还没有学 hook，或许还有更好的方法）</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210909194446988.png" alt="image-20210909194446988" data-fancybox="gallery"></p><p>（从掘友的文章里截的图）</p><p>这张图，非常形象的将纯 React 和 采用 Redux 的区别体现了出来</p><h2 id="_2-redux-的工作流程" tabindex="-1">2. Redux 的工作流程 <a class="header-anchor" href="#_2-redux-的工作流程" aria-label="Permalink to &quot;2. Redux 的工作流程&quot;">​</a></h2><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210909194900532.png" alt="image-20210909194900532" data-fancybox="gallery"></p><p>首先组件会在 Redux 中派发一个 <code>action</code> 方法，通过调用 <code>store.dispatch</code> 方法，将 <code>action</code> 对象派发给 <code>store</code> ，当 <code>store</code> 接收到 <code>action</code> 对象时，会将先前的 <code>state</code> 与传来的 <code>action</code> 一同发送给 <code>reducer</code> ，<code>reducer</code> 在接收到数据后，进行数据的更改，返回一个新的状态给 <code>store</code> ，最后由 <code>store</code> 更改 <code>state</code></p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/12/16e5fd1597faec4d~tplv-t2oaga2asx-watermark.awebp" alt="img" data-fancybox="gallery"></p><p>（图来自掘金社区，侵删）</p><h2 id="_3-redux-三个核心概念" tabindex="-1">3. Redux 三个核心概念 <a class="header-anchor" href="#_3-redux-三个核心概念" aria-label="Permalink to &quot;3. Redux 三个核心概念&quot;">​</a></h2><h4 id="_1-store" tabindex="-1">1. store <a class="header-anchor" href="#_1-store" aria-label="Permalink to &quot;1. store&quot;">​</a></h4><p><code>store</code> 是 Redux 的核心，可以理解为是 Redux 的数据中台，我们可以将任何我们想要存放的数据放在 <code>store</code> 中，在我们需要使用这些数据时，我们可以从中取出相应的数据。因此我们需要先创建一个 <code>store</code> ，在 Redux 中可以使用 <code>createStore</code> API 来创建一个 <code>store</code></p><p>在生产中，我们需要在 <code>src</code> 目录下的 <code>redux</code> 文件夹中新增一个 <code>store.js</code> 文件，在这个文件中，创建一个 <code>store</code> 对象，并暴露它</p><p>因此我们需要从 <code>redux</code> 中暴露两个方法</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">createStore</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">applyMiddleware</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">redux</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>并引入为 count 组件服务的 reducer</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> countReducer </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./count_reducer</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>最后调用 <code>createStore</code> 方法来暴露 <code>store</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createStore</span><span style="color:#A6ACCD;">(countReducer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">applyMiddleware</span><span style="color:#A6ACCD;">(thunk))</span></span></code></pre></div><p>这里采用了中间件，本文应该不会写到~</p><p>在 <code>store</code> 对象下有一些常用的内置方法</p><p>获取当前时刻的 <code>store</code> ，我们可以采用 <code>getStore</code> 方法</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> state </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getState</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>在前面我们的流程图中，我们需要通过 <code>store</code> 中的 <code>dispatch</code> 方法来派生一个 <code>action</code> 对象给 <code>store</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">action对象</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>最后还有一个 <code>subscribe</code> 方法，这个方法可以帮助我们订阅 <code>store</code> 的改变，只要 <code>store</code> 发生改变，这个方法的回调就会执行</p><p>为了监听数据的更新，我们可以将 <code>subscribe</code> 方法绑定在组件挂载完毕生命周期函数上，但是这样，当我们的组件数量很多时，会比较的麻烦，因此我们可以直接将 <code>subscribe</code> 函数用来监听整个 <code>App</code>组件的变化</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subscribe</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#F07178;">( </span><span style="color:#89DDFF;">&lt; </span><span style="color:#FFCB6B;">App</span><span style="color:#89DDFF;"> /&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="_2-action" tabindex="-1">2. action <a class="header-anchor" href="#_2-action" aria-label="Permalink to &quot;2. action&quot;">​</a></h4><p><code>action</code> 是 <code>store</code> 中唯一的数据来源，一般来说，我们会通过调用 <code>store.dispatch</code> 将 action 传到 store</p><p>我们需要传递的 <code>action</code> 是一个对象，它必须要有一个 <code>type</code> 值</p><p>例如，这里我们暴露了一个用于返回一个 <code>action</code> 对象的方法</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> createIncrementAction </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> INCREMENT</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    data</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>我们调用它时，会返回一个 <code>action</code> 对象</p><h4 id="_3-reducer" tabindex="-1">3. reducer <a class="header-anchor" href="#_3-reducer" aria-label="Permalink to &quot;3. reducer&quot;">​</a></h4><p>在 Reducer 中，我们需要指定状态的操作类型，要做怎样的数据更新，因此这个类型是必要的。</p><p>reducer 会根据 action 的指示，对 state 进行对应的操作，然后返回操作后的 state</p><p>如下，我们对接收的 action 中传来的 type 进行判断</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">countReducer</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">preState</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> initState</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">data</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">switch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">INCREMENT</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">preState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">data</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">DECREMENT</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">preState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">data</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">preState</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>更改数据，返回新的状态</p><h2 id="_4-创建-constant-文件" tabindex="-1">4. 创建 constant 文件 <a class="header-anchor" href="#_4-创建-constant-文件" aria-label="Permalink to &quot;4. 创建 constant 文件&quot;">​</a></h2><p>在我们正常的编码中，有可能会出现拼写错误的情况，但是我们会发现，拼写错误了不一定会报错，因此就会比较难搞。</p><p>我们可以在 <code>redux</code> 目录下，创建一个 <code>constant</code> 文件，这个文件用于定义我们代码中常用的一些变量，例如</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> INCREMENT </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">increment</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> DECREMENT </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">decrement</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>将这两个单词写在 <code>constant</code> 文件中，并对外暴露，当我们需要使用时，我们可以引入这个文件，并直接使用它的名称即可</p><p>直接使用 <code>INCREMENT</code> 即可</p><h2 id="_5-实现异步-action" tabindex="-1">5. 实现异步 action <a class="header-anchor" href="#_5-实现异步-action" aria-label="Permalink to &quot;5. 实现异步 action&quot;">​</a></h2><p>一开始，我们直接调用一个异步函数，这虽然没有什么问题，但是难道 redux 就不可以实现了吗？</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">incrementAsync</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">selectNumber</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> count</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">500</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>我们可以先尝试将它封装到 <code>action</code> 对象中调用</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> createIncrementAsyncAction </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">time</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 无需引入 store ，在调用的时候是由 store 调用的</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">dispatch</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">createIncrementAction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">time</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>当我们点击异步加操作时，我们会调用这个函数，在这个函数里接收一个延时加的时间，还有action所需的数据，和原先的区别只在于返回的时一个定时器函数</p><p>但是如果仅仅这样，很显然是会报错的，它默认需要接收一个对象</p><p>如果我们需要实现传入函数，那我们就需要告诉：你只需要默默的帮我执行以下这个函数就好！</p><p>这时我们就需要引入中间件，在原生的 <code>redux</code> 中暴露出 <code>applyMiddleware</code> 中间件执行函数，并引入 <code>redux-thunk</code> 中间件（需要手动下载）</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> thunk </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">redux-thunk</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>通过第二个参数传递下去就可以了</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createStore</span><span style="color:#A6ACCD;">(countReducer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">applyMiddleware</span><span style="color:#A6ACCD;">(thunk))</span></span></code></pre></div><p>注意：异步 action 不是必须要写的，完全可以自己等待异步任务的结果后再去分发同步action</p><h2 id="_6-redux-三大原则" tabindex="-1">6. Redux 三大原则 <a class="header-anchor" href="#_6-redux-三大原则" aria-label="Permalink to &quot;6. Redux 三大原则&quot;">​</a></h2><p>理解好 Redux 有助于我们更好的理解接下来的 React -Redux</p><h3 id="第一个原则" tabindex="-1">第一个原则 <a class="header-anchor" href="#第一个原则" aria-label="Permalink to &quot;第一个原则&quot;">​</a></h3><p><strong>单向数据流</strong>：整个 Redux 中，数据流向是单向的</p><p>UI 组件 ---&gt; action ---&gt; store ---&gt; reducer ---&gt; store</p><h3 id="第二个原则" tabindex="-1">第二个原则 <a class="header-anchor" href="#第二个原则" aria-label="Permalink to &quot;第二个原则&quot;">​</a></h3><p><strong>state 只读</strong>：在 Redux 中不能通过直接改变 state ，来控制状态的改变，如果想要改变 state ，则需要触发一次 action。通过 action 执行 reducer</p><h3 id="第三个原则" tabindex="-1">第三个原则 <a class="header-anchor" href="#第三个原则" aria-label="Permalink to &quot;第三个原则&quot;">​</a></h3><p><strong>纯函数执行</strong>：每一个reducer 都是一个纯函数，不会有任何副作用，返回是一个新的 state，state 改变会触发 store 中的 subscribe</p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2><p><a href="https://juejin.cn/post/6844903998139400200" target="_blank" rel="noreferrer">Redux + React-router 的入门📖和配置👩🏾‍💻教程</a></p><p>小册：<a href="https://juejin.cn/book/6945998773818490884" target="_blank" rel="noreferrer">React 进阶实践指南</a></p><hr><blockquote><p>非常感谢您的阅读，欢迎提出你的意见，有什么问题欢迎指出，谢谢！🎈</p></blockquote>`,83),p=[l];function t(c,r,y,i,d,F){return n(),a("div",null,p)}const C=s(e,[["render",t]]);export{A as __pageData,C as default};
