import{_ as s,c as a,o as n,V as o}from"./chunks/framework.3d11d069.js";const C=JSON.parse('{"title":"React 入门学习（六）-- TodoList 案例","description":"TodoList 案例在前端学习中挺重要的，从原生 JavaScript 的增删查改，到现在 React 的组件通信，都是一个不错的案例","frontmatter":{"title":"React 入门学习（六）-- TodoList 案例","date":"2021-08-26T16:57:35.000Z","id":1635581855,"tags":["react","案例"],"categories":["React入门学习"],"keywords":"react,todolist,小丞同学","description":"TodoList 案例在前端学习中挺重要的，从原生 JavaScript 的增删查改，到现在 React 的组件通信，都是一个不错的案例"},"headers":[],"relativePath":"pages/react/primary/todolist.md","filePath":"pages/react/primary/todolist.md","lastUpdated":1690466832000}'),l={name:"pages/react/primary/todolist.md"},p=o(`<p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/React-todolist.png" alt="React-todolist" data-fancybox="gallery"></p><blockquote><p>📢 大家好，我是小丞同学，一名<div color="#2e86de"><strong>准大二的前端爱好者</strong></div></p><p>📢 这篇文章是学习 React 练习中 TodoList 案例的操作笔记</p><p>📢 非常感谢你的阅读，不对的地方欢迎指正 🙏</p><p>📢 <div color="#f368e0"><strong>愿你忠于自己，热爱生活</strong></div></p></blockquote><h2 id="引言" tabindex="-1">引言 <a class="header-anchor" href="#引言" aria-label="Permalink to &quot;引言&quot;">​</a></h2><p>TodoList 案例在前端学习中挺重要的，从原生 JavaScript 的增删查改，到现在 React 的组件通信，都是一个不错的案例，这篇文章主要记录，还原一下通过 React 实现 TodoList 的全过程</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210826091013929.png" alt="image-20210826091013929" data-fancybox="gallery"></p><h2 id="一、拆分组件" tabindex="-1">一、拆分组件 <a class="header-anchor" href="#一、拆分组件" aria-label="Permalink to &quot;一、拆分组件&quot;">​</a></h2><p>首先第一步需要做的是将这个页面拆分成几个组件</p><p>首先顶部的输入框，可以完成添加项目的功能，可以拆分成一个 <strong>Header 组件</strong></p><p>中间部分可以实现一个渲染列表的功能，可以拆分成一个 <strong>List 组件</strong></p><p>在这部分里面，每一个待办事项都可以拆分成一个 <strong>Item 组件</strong></p><p>最后底部显示当前完成状态的部分，可以拆分成一个 <strong>Footer 组件</strong></p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210826092737826.png" alt="image-20210826092737826" data-fancybox="gallery"></p><p>在拆分完组件后，我们下一步要做的就是去实现这些组件的静态效果</p><h2 id="二、实现静态组件" tabindex="-1">二、实现静态组件 <a class="header-anchor" href="#二、实现静态组件" aria-label="Permalink to &quot;二、实现静态组件&quot;">​</a></h2><p>首先，我们可以先写好这个页面的静态页面，然后再分离组件，所以这就要求我们</p><p>以后写静态页面的时候，一定要有明确的规范</p><ol><li>打好注释</li><li>每个部分的 CSS 要写在一个地方，不要随意写</li><li>命名一定要规范</li><li>CSS 选择器不要关联太多层级</li><li>在写 HTML 时就要划分好布局</li></ol><p>这样有利于我们分离组件</p><p>首先，我们在 <code>src</code> 目录下，新建一个 <code>Components</code> 文件夹，用于存放我们的组件，然后在文件夹下，新建 <code>Header</code> 、<code>Item</code>、<code>List</code> 、<code>Footer</code> 组件文件夹，再创建其下的 <code>index.jsx</code>，<code>index.css</code> 文件，用于创建对应组件及其样式文件</p><div class="language-markdown"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">todolist</span></span>
<span class="line"><span style="color:#A6ACCD;">├─ package.json</span></span>
<span class="line"><span style="color:#A6ACCD;">├─ public</span></span>
<span class="line"><span style="color:#A6ACCD;">│  ├─ favicon.ico</span></span>
<span class="line"><span style="color:#A6ACCD;">│  └─ index.html</span></span>
<span class="line"><span style="color:#A6ACCD;">├─ src</span></span>
<span class="line"><span style="color:#A6ACCD;">│  ├─ App.css</span></span>
<span class="line"><span style="color:#A6ACCD;">│  ├─ App.jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">│  ├─ Components</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  ├─ Footer</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  ├─ index.css</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  └─ index.jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  ├─ Header</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  ├─ index.css</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  └─ index.jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  ├─ item</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  ├─ index.css</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  │  └─ index.jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │  └─ List</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │     ├─ index.css</span></span>
<span class="line"><span style="color:#A6ACCD;">│  │     └─ index.jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">│  └─ index.js</span></span>
<span class="line"><span style="color:#A6ACCD;">└─ yarn.lock</span></span></code></pre></div><p>最终目录结构如上</p><p>然后我们将每个组件，对应的 HTML 结构 CV 到对应组件的 <code>index.jsx</code> 文件中 <code>return</code> 出来，再将 CSS 样式添加到 <code>index.css</code> 文件中</p><p><strong>记得</strong>，在 <code>index.jsx</code> 中一定要引入 <code>index.css</code> 文件</p><p>实现了静态组件后，我们需要添加事件等，来实现动态组件</p><h2 id="三、实现动态组件" tabindex="-1">三、实现动态组件 <a class="header-anchor" href="#三、实现动态组件" aria-label="Permalink to &quot;三、实现动态组件&quot;">​</a></h2><h3 id="🍎-1-动态展示列表" tabindex="-1">🍎 1. 动态展示列表 <a class="header-anchor" href="#🍎-1-动态展示列表" aria-label="Permalink to &quot;🍎 1. 动态展示列表&quot;">​</a></h3><p>我们目前实现的列表项是固定的，我们需要它通过<strong>状态</strong>来维护，而不是通过<strong>组件标签</strong>来维护</p><p>首先我们知道，父子之间传递参数，可以通过 <code>state</code> 和 <code>props</code> 实现</p><p>我们通过在父组件也就是 <code>App.jsx</code> 中设置状态</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210826103418053.png" alt="image-20210826103418053" data-fancybox="gallery"></p><p>再将它传递给对应的渲染组件 <code>List</code></p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> todos </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">List</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">todos</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">}/&gt;</span></span></code></pre></div><p>这样在 <code>List</code> 组件中就能通过 <code>props</code> 来获取到 <code>todos</code></p><p>我们通过解构取出 <code>todos</code></p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> todos</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> updateTodo </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span></span></code></pre></div><p>再通过 <code>map</code> 遍历渲染 <code>Item</code> 数量</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">todo</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Item</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">key</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">todo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">} {...</span><span style="color:#A6ACCD;">todo</span><span style="color:#89DDFF;">}/&gt;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>同时由于我们的数据渲染最终是在 <code>Item</code> 组件中完成的，所以我们需要将数据传递给 <code>Item</code> 组件</p><p>这里有两个注意点</p><ol><li>关于 <code>key</code> 的作用在 diff 算法的文章中已经有讲过了，需要满足<strong>唯一性</strong></li><li>这里采用了简写形式 <code>{...todo}</code> ，这使得代码更加简洁，它代表的意思是</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">todo.id</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">todo.name</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> done </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">todo.done</span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>在 <code>Item</code> 组件中取出 <code>props</code> 即可使用</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> done </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span></span></code></pre></div><p>这样我们更改 <code>APP.jsx</code> 文件中的 <code>state</code> 就能驱动着 <code>Item</code> 组件的更新，如图</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-1.gif" alt="react-todolist-1" data-fancybox="gallery"></p><p>同时这里需要注意的是</p><p>对于复选框的选中状态，这里采用的是 <code>defaultChecked = {done}</code>，相比于 <code>checked</code> 属性，这个设定的是默认值，能够更改</p><h3 id="🍍-2-添加事项功能" tabindex="-1">🍍 2. 添加事项功能 <a class="header-anchor" href="#🍍-2-添加事项功能" aria-label="Permalink to &quot;🍍 2. 添加事项功能&quot;">​</a></h3><p>首先我们需要在 Header 组件中，绑定键盘事件，判断按下的是否为回车，如果为回车，则将当前输入框中的内容传递给 APP 组件</p><blockquote><p>因为，在目前的学习知识中，Header 组件和渲染组件 List 属于兄弟组件，没有办法进行直接的数据传递，因此可以将数据传递给 APP 再由 APP 转发给 List。</p></blockquote><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Header/index.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">handleKeyUp</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 结构赋值获取 keyCode,target</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">keyCode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">target</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 判断是不是回车</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">keyCode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">13</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">trim</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">alert</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">输入不能为空</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 准备一个todo对象</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todoObj</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">nanoid</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> done</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 传递给app</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addTodo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">todoObj</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 清空</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>我们在 <code>App.jsx</code> 中添加了事件 <code>addTodo</code> ，这样可以将 Header 组件传递的参数，维护到 <code>App</code> 的状态中</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// App.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">addTodo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">todoObj</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 追加一个 todo</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> todos</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>在这小部分中，需要我们注意的是，我们新建的 <code>todo</code> 对象，一定要保证它的 <code>id</code> 的唯一性</p><p>这里采用的 <code>nanoid</code> 库，这个库的每一次调用都会返回一个唯一的值</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nanoid</span></span></code></pre></div><p>安装这个库，然后引入</p><p>通过 <code>nanoid()</code> 即可生成唯一值</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-addtodo.gif" alt="react-todolist-addtodo" data-fancybox="gallery"></p><h3 id="🍋-3-实现鼠标悬浮效果" tabindex="-1">🍋 3. 实现鼠标悬浮效果 <a class="header-anchor" href="#🍋-3-实现鼠标悬浮效果" aria-label="Permalink to &quot;🍋 3. 实现鼠标悬浮效果&quot;">​</a></h3><p>接下来我们需要实现每个 <code>Item</code> 中的小功能</p><p>首先是鼠标移入时的变色效果</p><p>我的逻辑是，通过一个状态来维护是否鼠标移入，比如用一个 <code>mouse</code> 变量，值给 <code>false</code> 当鼠标移入时，重新设定状态为 <code>true</code> 当鼠标移出时设为 <code>false</code> ，然后我们只需要在 <code>style</code> 中用<code>mouse</code> 去设定样式即可</p><p>下面我们来代码实现</p><p>在 <code>Item</code> 组件中，先设定状态</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">state </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">mouse</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 标识鼠标移入，移出</span></span></code></pre></div><p>给元素绑定上鼠标移入，移出事件</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">li</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">onMouseEnter</span><span style="color:#89DDFF;">={this.</span><span style="color:#82AAFF;">handleMouse</span><span style="color:#A6ACCD;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">} </span><span style="color:#C792EA;">onMouseLeave</span><span style="color:#89DDFF;">={this.</span><span style="color:#82AAFF;">handleMouse</span><span style="color:#A6ACCD;">(</span><span style="color:#FF9CAC;">false</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">} &gt;&lt;</span><span style="color:#F07178;">li</span><span style="color:#89DDFF;">/&gt;</span></span></code></pre></div><p>当鼠标移入时，会触发 <code>onMouseEnter</code> 事件，调用 <code>handleMouse</code> 事件传入参数 <code>true</code> 表示鼠标进入，更新组件状态</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">handleMouse</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">flag</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> mouse</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">flag</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>再在 <code>li</code> 身上添加由 <code>mouse</code> 控制的背景颜色</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">={{</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">backgroundColor</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">mouse</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#ddd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">white</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}}</span></span></code></pre></div><p>同时通过 <code>mouse</code> 来控制删除按钮的显示和隐藏，做法和上面一样</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-mouse.gif" alt="react-todolist-mouse" data-fancybox="gallery"></p><p>观察 mouse 的变化</p><h3 id="🍉-4-复选框状态维护" tabindex="-1">🍉 4. 复选框状态维护 <a class="header-anchor" href="#🍉-4-复选框状态维护" aria-label="Permalink to &quot;🍉 4. 复选框状态维护&quot;">​</a></h3><p>我们需要将当前复选框的状态，维护到 <code>state</code> 当中</p><p>我们的思路是</p><p>在复选框中添加一个 <code>onChange</code> 事件来进行数据的传递，当事件触发时我们执行 <code>handleCheck</code> 函数，这个函数可以向 App 组件中传递参数，这样再在 App 中改变状态即可</p><p>首先绑定事件</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Item/index.jsx</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">checkbox</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">defaultChecked</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">done</span><span style="color:#89DDFF;">} </span><span style="color:#C792EA;">onChange</span><span style="color:#89DDFF;">={this.</span><span style="color:#82AAFF;">handleCheck</span><span style="color:#A6ACCD;">(id)</span><span style="color:#89DDFF;">} /&gt;</span></span></code></pre></div><p>事件回调</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">handleCheck</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">updateTodo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">checked</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>由于我们需要传递 <code>id</code> 来记录状态更新的对象，因此我们需要采用高阶函数的写法，不然函数会直接执行而报错，复选框的状态我们可以通过 <code>event.target.checked</code> 来获取</p><p>这样我们将我们需要改变状态的 <code>Item</code> 的 <code>id</code> 和改变后的状态，传递给了 App</p><p>内定义的<code>updateTodo</code> 事件，这样我们可以在 App 组件中操作改变状态</p><p>我们传递了两个参数 <code>id</code> 和 <code>done</code></p><p>通过遍历找出该 <code>id</code> 对应的 <code>todo</code> 对象，更改它的 <code>done</code> 即可</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// App.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">updateTodo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">done</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 处理</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">todoObj</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todoObj</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> todos</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>这里更改的方式是 <code>{ ...todoObj, done }</code>，首先会展开 <code>todoObj</code> 的每一项，再对 <code>done</code> 属性做覆盖</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-update.gif" alt="react-todolist-update" data-fancybox="gallery"></p><h3 id="🍏-5-限制参数类型" tabindex="-1">🍏 5. 限制参数类型 <a class="header-anchor" href="#🍏-5-限制参数类型" aria-label="Permalink to &quot;🍏 5. 限制参数类型&quot;">​</a></h3><p>在我们前面写的东西中，我们并没有对参数的<strong>类型以及必要性</strong>进行限制</p><p>在前面我们也学过这个，我们需要借助 <code>propTypes</code> 这个库</p><p>首先我们需要引入这个库，然后对 <code>props</code> 进行限制</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Header</span></span>
<span class="line"><span style="color:#A6ACCD;">static propTypes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">addTodo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> PropTypes</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">func</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">isRequired</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>在Header 组件中需要接收一个 <code>addTodo</code> 函数，所以我们进行一下限制</p><p>同时在 List 组件中也需要进行对 <code>todos</code> 以及 <code>updateTodo</code> 的限制</p><p>如果传入的参数不符合限制，则会报 <strong>warning</strong></p><h3 id="🍒-6-删除按钮" tabindex="-1">🍒 6. 删除按钮 <a class="header-anchor" href="#🍒-6-删除按钮" aria-label="Permalink to &quot;🍒 6. 删除按钮&quot;">​</a></h3><p>现在我们需要实现删除按钮的效果</p><p>这个和前面的挺像的，首先我们分析一下，我们需要在 <code>Item</code> 组件上的按钮绑定点击事件，然后传入被点击事项的 <code>id</code> 值，通过 <code>props</code> 将它传递给父元素 <code>List</code> ，再通过在 <code>List</code> 中绑定一个 <code>App</code> 组件中的删除回调，将 <code>id</code> 传递给 <code>App</code> 来改变 <code>state</code></p><p>首先我们先编写 点击事件</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Item/index.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">handleDelete</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deleteTodo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>绑定在点击事件的回调上</p><p>子组件想影响父组件的状态，需要父组件传递一个函数，因此我们在 <code>App</code> 中添加一个 <code>deleteTodo</code> 函数</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// app.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">deleteTodo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">todoObj</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> todos</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>然后将这个函数传递给 List 组件，再传递给 Item</p><p>增加一个判断</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;">(window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">confirm</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">确认删除</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deleteTodo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-detele.gif" alt="react-todolist-detele" data-fancybox="gallery"></p><h3 id="🍓-7-获取完成数量" tabindex="-1">🍓 7. 获取完成数量 <a class="header-anchor" href="#🍓-7-获取完成数量" aria-label="Permalink to &quot;🍓 7. 获取完成数量&quot;">​</a></h3><p>我们在 App 中向 <code>Footer</code> 组件传递 <code>todos</code> 数据，再去统计数据</p><p>统计 <code>done </code>为 <code>true</code> 的个数</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> doneCount </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">reduce</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">pre</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">todo</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pre</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">todo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>再渲染数据即可</p><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/image-20210826160505813.png" alt="image-20210826160505813" data-fancybox="gallery"></p><h3 id="🍊-8-全选按钮" tabindex="-1">🍊 8. 全选按钮 <a class="header-anchor" href="#🍊-8-全选按钮" aria-label="Permalink to &quot;🍊 8. 全选按钮&quot;">​</a></h3><p>首先我们需要在按钮上绑定事件，由于子组件需要改变父组件的状态，所以我们的操作和之前的一样，先绑定事件，再在 App 中传一个函数个 Footer ，再在 Footer 中调用这个函数并传入参数即可</p><p>这里需要特别注意的是</p><p><code>defaulChecked</code> 只有第一次会起作用，所以我们需要将前面写的改成 <code>checked</code> 添加 <code>onChange</code> 事件即可</p><p>首先我们先在 App 中给 Footer 传入一个函数 <code>checkAllTodo</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// App.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">checkAllTodo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">done</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">((</span><span style="color:#A6ACCD;font-style:italic;">todoObj</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> done</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> todos</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// render</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Footer</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">todos</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">} </span><span style="color:#C792EA;">checkAllTodo</span><span style="color:#89DDFF;">={this.</span><span style="color:#A6ACCD;">checkAllTodo</span><span style="color:#89DDFF;">}/&gt;</span></span></code></pre></div><p>然后我们需要在 Footer 中调用一下</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">handleCheckAll</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">checkAllTodo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">checked</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>这里我们传入了一个参数：当前按钮的状态，用于全选和取消全选</p><p>同时我们需要排除总数为0 时的干扰</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">checkbox</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">checked</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">doneCount </span><span style="color:#89DDFF;">===</span><span style="color:#A6ACCD;"> total </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> total </span><span style="color:#89DDFF;">!==</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">} </span><span style="color:#C792EA;">onChange</span><span style="color:#89DDFF;">={this.</span><span style="color:#A6ACCD;">handleCheckAll</span><span style="color:#89DDFF;">} /&gt;</span></span></code></pre></div><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-all.gif" alt="react-todolist-all" data-fancybox="gallery"></p><h3 id="🥭-9-删除已完成" tabindex="-1">🥭 9. 删除已完成 <a class="header-anchor" href="#🥭-9-删除已完成" aria-label="Permalink to &quot;🥭 9. 删除已完成&quot;">​</a></h3><p>给删除按钮添加一个点击事件，回调中调用 App 中添加的删除已完成的函数，全都一个套路</p><p><strong>强烈建议这个自己打</strong></p><p>首先在 Footer 组件中调用传来的函数，在 App 中定义函数，过滤掉 <code>done</code> 为 <code>true</code> 的，再更新状态即可</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// App.jsx</span></span>
<span class="line"><span style="color:#82AAFF;">clearAllDone</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">todoObj</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">todoObj</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> todos</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newTodos</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><img src="https://ljcimg.oss-cn-beijing.aliyuncs.com/img/react-todolist-clear.gif" alt="react-todolist-clear" data-fancybox="gallery"></p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><ol><li>注意：className、style 写法</li><li>父组件给子组件传递数据，采用 <code>props</code></li><li>子组件给父组件传递数据，通过 <code>props</code>，同时提前给子组件传递一个函数</li><li>注意 <code>defaultChecked</code> 和 <code>checked</code> 的区别</li><li>一定要自己敲一下，好好理解数据传递</li></ol><blockquote><p>非常感谢您的阅读，欢迎提出你的意见，有什么问题欢迎指出，谢谢！🎈</p></blockquote>`,138),e=[p];function t(c,r,y,F,D,i){return n(),a("div",null,e)}const A=s(l,[["render",t]]);export{C as __pageData,A as default};
